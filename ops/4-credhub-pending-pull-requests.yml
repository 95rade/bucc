# Remove when merged: https://github.com/cloudfoundry/bosh-deployment/pull/37
#
- type: replace
  path: /releases/name=credhub/url
  value: https://bosh.io/d/github.com/pivotal-cf/credhub-release?v=0.6.1

- type: replace
  path: /releases/name=credhub/version?
  value: 0.6.1

- type: replace
  path: /releases/name=credhub/sha1?
  value: 5ab4c4ef3d67f8ea07d78b1a87707e7520a97ab7


# Remove when merged: https://github.com/cloudfoundry/bosh-deployment/pull/44
#
- type: remove
  path: /instance_groups/name=bosh/jobs/name=credhub/properties/credhub/user_management

- type: replace
  path: /instance_groups/name=bosh/jobs/name=credhub/properties/credhub/authentication?
  value:
    uaa:
      url: "https://((internal_ip)):8443"
      verification_key: ((uaa_jwt_signing_key.public_key))


- type: remove
  path: /instance_groups/name=bosh/jobs/name=credhub/properties/credhub/encryption

- type: replace
  path: /instance_groups/name=bosh/jobs/name=credhub/properties/credhub/encryption?
  value:
    keys:
    - provider_name: internal
      active: true
      encryption_password: ((credhub_encryption_password))
    providers:
    - name: internal
      type: internal


- type: replace
  path: /variables/-
  value:
    name: credhub_encryption_password
    type: password

- type: replace
  path: /variables/name=credhub_tls/options/alternative_names/-
  value: "127.0.0.1"

# Remove when merged https://github.com/cloudfoundry/bosh-deployment/pull/37
#
- type: remove
  path: /instance_groups/name=bosh/jobs/name=uaa/properties/uaa/clients/credhub?

- type: replace
  path: /instance_groups/name=bosh/jobs/name=uaa/properties/uaa/clients/credhub_cli?
  value:
    override: true
    authorized-grant-types: password,refresh_token
    access-token-validity: 60
    authorities: ""
    authorized-grant-types: password,refresh_token
    override: true
    refresh-token-validity: 1800
    scope: credhub.read,credhub.write
    secret: ""
 